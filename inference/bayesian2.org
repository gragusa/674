Lecture 2 on Bayesian inference
#+AUTHOR: Gray Calhoun
#+DATE: December 2nd, 2014, version \version

* Prior distributions
** Basic prior distributions
   + We've already talked about conjugate priors
     + Easy to use
     + Available for some families (binomial, normal, etc)
     + Often one parameterization can be interpreted as "no information"
     + Often unavailable or has other unappealing properties
   + "Uninformative" priors
     + "Flat prior" usually isn't uninformative
     + The "Jeffreys prior" is a mostly uninformative prior designed
       to satisfy some invariance principles
     + "Reference prior" is another (Berger, Bernardo, Sun, 2009)
     + There are even more...
   + "Subjective priors"
     + If you actually know something useful about the system you're
       studying, you can put it into the model as a prior density
     + DSGE models can be used to produce priors
   + Empirical Bayes: why not estimate the parameters of the prior?
** Priors used in time-series
   + We will/may talk about DSGE-based priors in our last class
     meeting
   + First, suppose we have a regression model:
     \[
     y_t = x_t'\beta + e_t
     \]
     where $e_t \mid x_1,\dots,x_T \sim N(0, \sigma)$
   + Conjugate prior for $\beta$ and $\sigma$ is Normal-inverse Gamma.
   + Start with the priors
     \begin{align*}
     \beta \mid \sigma &\sim N(b, \sigma^2 V) \\
     1/\sigma^2 &\sim \textit{gamma}(N, \lambda)
     \end{align*}
     where $b$, $V$, $N$, and $\lambda$ are set by the researcher.
** Priors used in time-series
   + Then we get the posterior
     \begin{align*}
     \beta \mid \sigma, Y  &\sim N(b^*, \sigma^2 V^*) \\
     1/\sigma^2 \mid Y &\sim \textit{gamma}(N + T, \lambda + \lambda^* ) \\
     b^* &= V^*V^{-1} b + V^* \sum_{t=1}^T x_t y_t\\
     V^* &= (V^{-1} + X'X)^{-1} \\
     \lambda^* &= \sum_{t=1}^T (y_t - x_t'\hat\beta)^2 + (\hat\beta - b)' V^{-1}V^* X'X  (\hat\beta - b)
     \end{align*}
   + Interpretation of prior parameters: it's as though we had an
     additional dataset with
     \begin{align*}
     V^{-1} &\approx X'X & N &\text{ observations} \\
     b &\approx \hat\beta & \lambda/N &\approx \hat\sigma^2
     \end{align*}
     $N, \lambda, V^{-1} \to 0$ is "noninformative"
** Priors used for time-series
   + Same prior is used for AR(p) and VAR(p)
     + Normal-inverse Gamma is conjugate prior for AR(p) too
     + Normal-inverse Wishart is conjugate prior for VAR(p)
     + Wishart is a multivariate version of the gamma
   + "Litterman prior" for a VAR
     + Normal-inverse Wishart
     + Diffuse prior for constant terms
     + For lags of the same variable
       + Coefficient on first lag: $N(1, \gamma^2)$
       + Coefficient on \(j\)th lag ($j > 1$): $N(0, (\gamma/j)^2)$
     + For lags of different variables (eq $k$, variable $i$)
       + \(j\)th lag: $N(0, w \gamma \tau_i / j \tau_k)$
       + has a correction for variances of different series
       + $w$ is a tuning parameter (can be estimated)
     + If series is already differenced (i.e. GDP growth vs. GDP), use
       0 for the first lag as well
** How do we deal with stationarity more generally?
   + Often people don't, or just truncate coefficients to ensure
     stationarity.
   + There are some papers that look at potentially nonstationary
     priors: Phillips (1991), Berger and Yang (1994), but not many.
   + Cointegration is similar: treat the number of cointegrating
     relationships as known
   + As you can imagine, I find this very unsatisfying.
* Simulating from posterior
** Need for simulations
   + Even in our simplest example, the easiest way to work with the
     posterior is to simulate from it
   + Most quantities can be expressed as expectations:
     \[
     \Pr[\theta \leq c \mid \textit{data}] = E(1\{\theta \leq c\} \mid \textit{data})
     \]
   + Bayes's theorem gives us a formula for the density function, not
     necessarily a good way to directly generate ovservations
   + Conjugate priors help here
   + We'll cover simulation abstractly and briefly today, more after break
** Rejection sampling
   Suppose we can generate data from $f$, but want to generate data
   from $g$.
   
   If there is a $c$ s.t. $g(x) \leq c f(x)$ for all $x$, we can use
   the Accept-Reject algorithm:
   1) Generate a candidate $x$ from $f$
   2) With probability $g(x) / c f(x)$, accept this value of
      $x$. Otherwise, go back to step 1.

   When it's available, this can work great. Existance of this $c$ is
   not always guaranteed, and even if it is, finding it can be hard.
** Importance sampling
   Suppose we can generate data from $f$, but want to generate data
   from $g$ to calculate the expected value of some $h(X)$ with $X
   \sim g$.
   * Generate $x_1,\dots,x_n$ from $f$. Then
     \[
       h(X) \approx \sum_{i=1}^n h(x_i) g(x_i)/f(x_i)
     \]
   * Why? 
     \begin{align*}
       \sum_{i=1}^n h(x_i) g(x_i)/f(x_i) &\xrightarrow_{n \to \infty} E h(X) g(X)/f(X) \\
       &= \int h(x) \tfrac{g(x)}{f(x)} f(x) dx \\
       &= \int h(x) g(x) dx
     \end{align*}
   * Doing this naively can be _very_ inefficient.
* Conclusion
** Next week (after Thanksgiving break)
   + MCMC (more simulation tools)
   + State Space models
   + DSGE models
   + _Have fun!_
* End matter
** License and copying
   Copyright (c) 2013-2014 Gray Calhoun. Permission is granted to copy,
   distribute and/or modify this document under the terms of the GNU
   Free Documentation License, Version 1.3 or any later version
   published by the Free Software Foundation; with no Invariant
   Sections, no Front-Cover Texts, and no Back-Cover Texts. A copy of
   the license is included in the file LICENSE.tex and is also
   available online at [[http://www.gnu.org/copyleft/fdl.html]].
** COMMENT slide setup
#+BEAMER_FRAME_LEVEL: 2
#+OPTIONS: toc:nil
#+LaTeX_CLASS: beamer
#+LaTeX_CLASS_OPTIONS: [presentation,fleqn,t,serif,10pt]
#+STARTUP: beamer
#+LaTeX_HEADER: \usepackage{url,microtype,tikz}
#+LaTeX_HEADER: \urlstyle{same}
#+LaTeX_HEADER: \frenchspacing
#+LaTeX_HEADER: \usepackage{xcolor}
#+LaTeX_HEADER: \usepackage[osf]{sourcecodepro}
#+LaTeX_HEADER: \usepackage[charter]{mathdesign}
#+LaTeX_HEADER: \usecolortheme{dove}
#+LaTeX_HEADER: \usemintedstyle{pastie}
#+LaTeX_HEADER: \DisableLigatures{family = tt*}
#+LaTeX_HEADER: \setbeamertemplate{navigation symbols}{}
#+LaTeX_HEADER: \setbeamertemplate{items}[circle]
#+LaTeX_HEADER: \setbeamerfont{sec title}{parent=title}
#+LaTeX_HEADER: \setbeamercolor{sec title}{parent=titlelike}
#+LaTeX_HEADER: \setbeamerfont{frametitle}{size=\normalsize}
#+LaTeX_HEADER: \setbeamertemplate{frametitle}{\vspace{\baselineskip}\underline{\insertframetitle\vphantom{g}}}
#+LaTeX_HEADER: \setbeamertemplate{itemize/enumerate body begin}{\setlength{\leftmargini}{0pt}}
#+LaTeX_HEADER: \setbeamertemplate{enumerate item}{\insertenumlabel.}
#+LaTeX_HEADER: \setbeamertemplate{enumerate subitem}{\insertenumlabel.\insertsubenumlabel.}
#+LaTeX_HEADER: \setbeamertemplate{enumerate subsubitem}{\insertenumlabel.\insertsubenumlabel.\insertsubsubenumlabel.}
#+LaTeX_HEADER: \setbeamertemplate{enumerate mini template}{\insertenumlabel}
#+LaTeX_HEADER: \input{../VERSION.tex}
#+LaTeX_HEADER: \input{../tex/macros.tex}

#+MACRO: s \vspace{\baselineskip}
